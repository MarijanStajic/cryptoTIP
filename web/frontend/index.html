<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CryptoTIP</title>

    <link rel="stylesheet" href="styles.css" />
    <script defer src="/app.js"></script>

    <style>
        .layout {
            display: grid;
            gap: 16px;
            grid-template-columns: 1fr;
        }

        @media (min-width: 1024px) {
            .layout {
                grid-template-columns: 0.8fr 1.2fr;
                align-items: start;
            }
        }
    </style>
</head>

<body class="min-h-screen bg-neutral-950 text-neutral-100">
    <div class="mx-auto max-w-6xl px-4 py-10">
        <h1 class="text-center text-3xl font-bold tracking-tight">CryptoTIP</h1>

        <div class="mt-10 layout">
            <div class="flex flex-col gap-4">
                <div class="rounded-2xl border border-neutral-800 bg-neutral-900/40 p-6 shadow">
                    <div class="flex items-center justify-between gap-3">
                        <h2 class="text-sm font-semibold text-neutral-200">Connexion</h2>
                        <div class="flex gap-2">
                            <button id="connectWsOnlyBtn"
                                class="rounded-lg border border-neutral-700 bg-neutral-950 px-4 py-2 text-sm font-semibold text-neutral-100 hover:bg-neutral-900">
                                Step by step
                            </button>
                            <button id="connectBtn"
                                class="rounded-lg bg-neutral-100 px-4 py-2 text-sm font-semibold text-neutral-900 hover:bg-white">
                                Connect
                            </button>
                        </div>
                    </div>

                    <div class="mt-4 grid gap-4">
                        <div class="grid gap-2">
                            <label for="wsUrl" class="text-sm font-medium text-neutral-200">WS URL</label>
                            <input id="wsUrl" type="text" value="http://localhost:3001"
                                class="w-full rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm text-neutral-100 outline-none focus:border-neutral-400" />
                        </div>

                        <div class="grid gap-2">
                            <label for="flaskUrl" class="text-sm font-medium text-neutral-200">Flask URL</label>
                            <input id="flaskUrl" type="text" value="http://localhost:5000"
                                class="w-full rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm text-neutral-100 outline-none focus:border-neutral-400" />
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div class="grid gap-2">
                                <label for="userId" class="text-sm font-medium text-neutral-200">Your ID</label>
                                <input id="userId" type="text" value="A"
                                    class="w-full rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm text-neutral-100 outline-none focus:border-neutral-400" />
                            </div>

                            <div class="grid gap-2">
                                <label for="peerId" class="text-sm font-medium text-neutral-200">To</label>
                                <input id="peerId" type="text" value="B"
                                    class="w-full rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm text-neutral-100 outline-none focus:border-neutral-400" />
                            </div>
                        </div>

                        <div class="rounded-xl border border-neutral-800 bg-black/20 p-3">
                            <div class="flex items-center justify-between">
                                <div class="text-xs font-semibold text-neutral-300">Pas à pas (connexion)</div>
                                <button id="resetStepsBtn"
                                    class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-1.5 text-xs text-neutral-200 hover:bg-neutral-900">
                                    Reset
                                </button>
                            </div>

                            <div class="mt-3 grid grid-cols-2 gap-2">
                                <button id="stepRegisterBtn"
                                    class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm hover:bg-neutral-900 disabled:opacity-40 disabled:hover:bg-neutral-950"
                                    disabled>
                                    1) Register
                                </button>
                                <button id="stepLoadKeyBtn"
                                    class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm hover:bg-neutral-900 disabled:opacity-40 disabled:hover:bg-neutral-950"
                                    disabled>
                                    2) Load my key
                                </button>
                                <button id="stepAnnounceKeyBtn"
                                    class="col-span-2 rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm hover:bg-neutral-900 disabled:opacity-40 disabled:hover:bg-neutral-950"
                                    disabled>
                                    3) Announce my key
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div
                    class="flex min-h-0 flex-1 flex-col rounded-2xl border border-neutral-800 bg-neutral-900/40 p-6 shadow">
                    <div class="flex items-center justify-between">
                        <h2 class="text-sm font-semibold text-neutral-200">Chat</h2>
                        <button id="clearChat"
                            class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-1.5 text-xs text-neutral-200 hover:bg-neutral-900">
                            Clear
                        </button>
                    </div>

                    <div id="chatLog"
                        class="mt-3 min-h-0 flex-1 overflow-y-auto rounded-xl border border-neutral-800 bg-black/40 p-4 font-mono text-sm leading-snug text-neutral-100 text-left whitespace-normal break-words">
                    </div>

                    <div class="mt-3 flex gap-2">
                        <input id="messageInput" type="text"
                            class="w-full rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm text-neutral-100 outline-none placeholder:text-neutral-600 focus:border-neutral-400"
                            placeholder="Type a message..." />
                        <button id="sendBtn"
                            class="rounded-lg bg-neutral-100 px-4 py-2 text-sm font-semibold text-neutral-900 hover:bg-white">
                            Send
                        </button>
                    </div>

                    <div class="mt-3 rounded-xl border border-neutral-800 bg-black/20 p-3">
                        <div class="text-xs font-semibold text-neutral-300">Pas à pas (envoi)</div>
                        <div class="mt-3 grid grid-cols-2 gap-2">
                            <button id="stepRequestPeerKeyBtn"
                                class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm hover:bg-neutral-900 disabled:opacity-40 disabled:hover:bg-neutral-950"
                                disabled>
                                4) Request peer key
                            </button>
                            <button id="stepSetPeerKeyBtn"
                                class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm hover:bg-neutral-900 disabled:opacity-40 disabled:hover:bg-neutral-950"
                                disabled>
                                5) Set peer key
                            </button>
                            <button id="stepEncryptBtn"
                                class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm hover:bg-neutral-900 disabled:opacity-40 disabled:hover:bg-neutral-950"
                                disabled>
                                6) Encrypt
                            </button>
                            <button id="stepSendCipherBtn"
                                class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-2 text-sm hover:bg-neutral-900 disabled:opacity-40 disabled:hover:bg-neutral-950"
                                disabled>
                                7) Send cipher
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="rounded-2xl border border-neutral-800 bg-neutral-900/40 p-6 shadow">
                <div class="flex items-center justify-between">
                    <h2 class="text-sm font-semibold text-neutral-200">Logs techniques</h2>
                    <button id="clearTech"
                        class="rounded-lg border border-neutral-700 bg-neutral-950 px-3 py-1.5 text-xs text-neutral-200 hover:bg-neutral-900">
                        Clear
                    </button>
                </div>

                <div id="techLog"
                    class="mt-3 h-[72vh] overflow-y-auto rounded-xl border border-neutral-800 bg-black/60 p-4 font-mono text-xs leading-relaxed text-neutral-100 whitespace-pre-wrap">
                </div>
            </div>
        </div>
    </div>

    <script>
        const clearTech = document.getElementById("clearTech");
        const clearChat = document.getElementById("clearChat");
        const techLog = document.getElementById("techLog");
        const chatLog = document.getElementById("chatLog");
        if (clearTech && techLog) clearTech.addEventListener("click", () => (techLog.textContent = ""));
        if (clearChat && chatLog) clearChat.addEventListener("click", () => (chatLog.textContent = ""));
    </script>
</body>

</html>